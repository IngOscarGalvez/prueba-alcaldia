import{Z as P}from"./index.esm-5156d63d.js";import{B as y,L as k}from"./Breadcrumb-a77a5cca.js";import{V as x,S as u}from"./sweetalert2.all-bddd6dd7.js";import{u as I,r as _,o as l,c as i,a as b,b as e,g as S,h as F,t as d,w as B,d as h,v as g,n as c,f as m,x as L,F as p,m as U}from"./app-9aaf36b4.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";const R={components:{Breadcrumb:y,Head:P,VueGoodTable:x},layout:k,setup(){return{form:I({name:null,email:null,password:null,role:""})}},data(){return{isLoading:!1,columns:[{label:"Nombre",field:"name",filterOptions:{enabled:!0,placeholder:"Buscar por Nombre"}},{label:"Email",field:"email",filterOptions:{enabled:!0,placeholder:"Buscar por Email"}},{label:"Roles",field:"roles",slot:"roles"},{label:"Opciones",field:"id",slot:"modify"}],rows:[],totalRecords:0,serverParams:{columnFilters:{},sort:{field:"",type:""},page:1,perPage:10},paginationOptions:{enabled:!0,perPage:10,perPageDropdown:[10,20,50,100],nav:!0},title_modal:"",crud:"",updateId:0,deleteId:0,roles:[]}},methods:{loadItems(){axios.post("user/getData",this.serverParams).then(o=>{this.rows=o.data.data,this.totalRecords=o.data.total})},updateParams(o){this.serverParams=Object.assign({},this.serverParams,o)},onPageChange(o){this.updateParams({page:o.currentPage}),this.loadItems()},onPerPageChange(o){this.updateParams({perPage:o.currentPerPage}),this.loadItems()},onSortChange(o){this.updateParams({sortKey:o[0].field,sortOrder:o[0].type}),this.loadItems()},onColumnFilter(o){this.updateParams(o),this.loadItems()},form_create(){this.title_modal="Agregar Usuario",this.crud="create"},form_show(o){this.title_modal="Actualizar Usuario",this.crud="update",this.updateId=o,this.show()},show(){const o=`/users/${this.updateId}`;axios.get(o).then(a=>{this.form.name=a.data.name,this.form.email=a.data.email}).catch(a=>{console.log(a)})},delete(){const o=`/users/${this.deleteId}`;axios.delete(o).then(a=>{u.fire({icon:"success",title:"¡Usuario Eliminado!",text:"La información se ha eliminado correctamente."}),this.loadItems()}).catch(a=>{console.log(a)})},form_delete(o){this.deleteId=o,u.fire({title:"Vas a Elimminar el usuario?",showDenyButton:!0,confirmButtonText:"Si"}).then(a=>{a.isConfirmed&&this.delete()})},send(){switch(this.crud){case"create":this.form.post("/users",{preserveScroll:!0,onSuccess:()=>{this.form.reset(),u.fire({icon:"success",title:"¡Guardado exitoso!",text:"La información se ha guardado correctamente."}),$("#modalCrud").modal("hide"),this.loadItems()}});break;case"update":this.form.put(`/users/${this.updateId}`,{preserveScroll:!0,onSuccess:()=>{this.form.reset(),u.fire({icon:"success",title:"¡Actualización exitosa!",text:"La información se ha actualizado correctamente."}),$("#modalCrud").modal("hide"),this.loadItems()}});break}},getRoles(){axios.get("user/getRoles").then(o=>{this.roles=o.data})}},mounted(){this.loadItems(),this.getRoles()}},N={class:"content mt-3"},D={class:"container-fluid"},E=e("i",{class:"fas fa-plus"},null,-1),O=e("br",null,null,-1),z=e("br",null,null,-1),A={key:0},M=["onClick"],T=e("i",{class:"fas fa-pencil"},null,-1),G=[T],H=["onClick"],j=e("i",{class:"fas fa-trash"},null,-1),K=[j],Z={key:1},q={class:"modal fade",id:"modalCrud",tabindex:"-1","aria-labelledby":"modalCrud","aria-hidden":"true"},J={class:"modal-dialog modal-lg"},Q={class:"modal-content"},W={class:"modal-header"},X={class:"modal-title",id:"exampleModalLabel"},Y=e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"×")],-1),ee={class:"modal-body"},oe={class:"form-group"},ae=e("label",{for:"name",class:"col-form-label"},"Nombre:",-1),se={key:0,id:"nameFeedback",class:"invalid-feedback"},te={class:"form-group"},re=e("label",{for:"email",class:"col-form-label"},"Email:",-1),le={key:0,id:"emailFeedback",class:"invalid-feedback"},ie={class:"form-group"},de=e("label",{for:"password",class:"col-form-label"},"Contraseña:",-1),ne={key:0,id:"passwordFeedback",class:"invalid-feedback"},me={class:"form-group"},ce=e("label",{for:"role",class:"col-form-label"},"Rol:",-1),ue=e("option",{value:""},"Seleccione Uno",-1),he=["value"],fe={key:0,id:"roleFeedback",class:"invalid-feedback"},_e={class:"modal-footer"},be=e("button",{type:"button",class:"btn btn-danger","data-dismiss":"modal"},"Cerrar",-1),ge=["disabled"];function pe(o,a,ve,s,n,r){const v=_("Head"),C=_("Breadcrumb"),w=_("vue-good-table");return l(),i(p,null,[b(v,{title:"Usuario"}),b(C,{"back-title":"Dashboard","back-link":"/dashboard","active-title":"Usuario"}),e("section",N,[e("div",D,[e("button",{class:"btn btn-primary btn-sm",onClick:a[0]||(a[0]=(...t)=>r.form_create&&r.form_create(...t)),"data-toggle":"modal","data-target":"#modalCrud"},[E,S(" Agregar Usuario")]),O,z,b(w,{mode:"remote",onPageChange:r.onPageChange,onSortChange:r.onSortChange,onColumnFilter:r.onColumnFilter,onPerPageChange:r.onPerPageChange,totalRows:n.totalRecords,isLoading:n.isLoading,"pagination-options":{enabled:!0},rows:n.rows,columns:n.columns,styleClass:"vgt-table condensed bordered striped"},{"table-row":F(t=>[t.column.field=="id"?(l(),i("div",A,[e("button",{class:"btn btn-primary btn-sm","data-toggle":"modal","data-target":"#modalCrud",onClick:f=>r.form_show(t.row.id)},G,8,M),e("button",{class:"btn btn-danger btn-sm",onClick:f=>r.form_delete(t.row.id)},K,8,H)])):m("",!0),t.column.field=="roles"?(l(),i("div",Z,d(t.row.roles.map(f=>f.name).join(", ")),1)):m("",!0)]),_:1},8,["onPageChange","onSortChange","onColumnFilter","onPerPageChange","totalRows","isLoading","rows","columns"])]),e("div",q,[e("div",J,[e("div",Q,[e("div",W,[e("h5",X,d(n.title_modal),1),Y]),e("form",{onSubmit:a[5]||(a[5]=B((...t)=>r.send&&r.send(...t),["prevent"])),autocomplete:"off"},[e("div",ee,[e("div",oe,[ae,h(e("input",{type:"text",class:c(["form-control",{"is-invalid":s.form.errors.name}]),id:"name","onUpdate:modelValue":a[1]||(a[1]=t=>s.form.name=t)},null,2),[[g,s.form.name]]),s.form.errors.name?(l(),i("div",se,d(s.form.errors.name),1)):m("",!0)]),e("div",te,[re,h(e("input",{type:"email",class:c(["form-control",{"is-invalid":s.form.errors.email}]),id:"email","onUpdate:modelValue":a[2]||(a[2]=t=>s.form.email=t)},null,2),[[g,s.form.email]]),s.form.errors.email?(l(),i("div",le,d(s.form.errors.email),1)):m("",!0)]),e("div",ie,[de,h(e("input",{type:"password",class:c(["form-control",{"is-invalid":s.form.errors.password}]),id:"password","onUpdate:modelValue":a[3]||(a[3]=t=>s.form.password=t)},null,2),[[g,s.form.password]]),s.form.errors.password?(l(),i("div",ne,d(s.form.errors.password),1)):m("",!0)]),e("div",me,[ce,h(e("select",{name:"role",id:"role",class:c(["form-control",{"is-invalid":s.form.errors.role}]),"onUpdate:modelValue":a[4]||(a[4]=t=>s.form.role=t)},[ue,(l(!0),i(p,null,U(n.roles,t=>(l(),i("option",{value:t.name},d(t.name),9,he))),256))],2),[[L,s.form.role]]),s.form.errors.role?(l(),i("div",fe,d(s.form.errors.role),1)):m("",!0)])]),e("div",_e,[be,e("button",{type:"submit",class:c(["btn btn-primary",{"opacity-25":s.form.processing}]),disabled:s.form.processing},"Guardar",10,ge)])],32)])])])])],64)}const xe=V(R,[["render",pe]]);export{xe as default};
